=head1 NAME

aa-stage2 - Stage 2: Initialyzing system

=head1 SYNOPSIS

B<aa-stage2>

=head1 DESCRIPTION

B<aa-stage2>(1) is an B<execline> script called by B<aa-stage1> once the runtime
repository has been created and B<s6-svscan> is running as PID 1, to actually
perform all initialization tasks.

It will log messages into file I</var/log/boot/current>, prefixing them with a
TAI timestamp via B<s6-tai64n>.

It starts all services via B<aa-start>(1) using I</etc/anopa/listdirs/onboot> as
listdir, unless argument B<aa> was specified on kernel command line, in which
case I</etc/anopa/listdirs/ARGVALUE> is used as listdir intead.

After B<aa-start>(1) has run, and if it exists, B<aa-stage2>(1) will execute
I</run/services/.anopa/post-start> with B<aa-start>(1)'s return code as
argument. This allows to e.g. open a shell if something went terribly wrong.

Note that file descriptor 3 will remain open for writing and connected to the
logger, so anything written there will be timestamped & logged.

For an example, see B<aa-post-stage2>(1)
